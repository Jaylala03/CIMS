@model CIMS.Models.UserModel
@{
    Layout = "~/Views/Shared/_InternalLayout.cshtml";
}


<div class="row bg-title">
    <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
        <h4 class="page-title">Users</h4>
    </div>
    <div class="col-lg-9 col-sm-8 col-md-8 col-xs-12">
        <ol class="breadcrumb">
            <li><a href='@Url.Content("~/Home/Index")'>Home</a></li>
            <li class="active">Users</li>
        </ol>
    </div>

</div>

<div id="msgDiv">
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success">@TempData["SuccessMessage"]</div>
    }
    @if (TempData["ErrorMessage"] != null)
    {

        <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
    }
</div>
<div class="row">
    <div class="col-md-12">
      
          
              
@using (Html.BeginForm("Users", "Admin", FormMethod.Post, new { enctype = "multipart/form-data", autocomplete = "off" }))
                    {

                <div class="col-md-6">
                    <div class="white-box clearfix" style="min-height: 377px;">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label">First Name</label>
                                    @Html.HiddenFor(m => m.ID)
                                    @Html.HiddenFor(m => m.Roles)
                                    @Html.TextBoxFor(m => m.FirstName, null, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(m => m.FirstName, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label">Last Name</label>

                                    @Html.TextBoxFor(m => m.LastName, null, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(m => m.LastName, "", new { @class = "text-danger" })
                                </div>
                            </div>

                        </div>


                        <div class="form-group">
                            <label class="control-label">Email</label>

                            @Html.TextBoxFor(m => m.EMail, null, new { @class = "form-control" })
                            @Html.ValidationMessageFor(m => m.EMail, "", new { @class = "text-danger" })
                        </div>
                        <div class="form-group">
                            <label class="control-label">User Name</label>

                            @Html.TextBoxFor(m => m.UserName, null, new { @class = "form-control" })
                            @Html.ValidationMessageFor(m => m.UserName, "", new { @class = "text-danger" })
                        </div>
                        @if (Model.ID == 0)
                        {
                            <div class="form-group">
                                <label class="control-label">Password</label>

                                @Html.PasswordFor(m => m.Password, new { @class = "form-control" })
                                @Html.ValidationMessageFor(m => m.Password, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group">
                                <label class="control-label">Confirm Password</label>

                                @Html.PasswordFor(m => m.ConfirmPassword, new { @class = "form-control" })
                                @Html.ValidationMessageFor(m => m.ConfirmPassword, "", new { @class = "text-danger" })
                            </div>
                        }

                      
                    </div>
                    </div>
              
                <div class="col-md-6">
                  <div class="white-box clearfix" style="min-height: 490px;"> 
                      <div class="form-group">
                          @Html.CheckBoxFor(m => m.IsDispatchable)
                          <label class="control-label">Is Dispachable</label>
                          @Html.ValidationMessageFor(m => m.IsDispatchable, "", new { @class = "text-danger" })
                      </div>
                    <div class="form-group">
                        <label class="control-label">Initials</label>

                        @Html.TextBoxFor(m => m.Initials, null, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.Initials, "", new { @class = "text-danger" })
                    </div>
                    <div class="form-group">
                        <label class="control-label">Unit ID</label>

                        @Html.TextBoxFor(m => m.UnitID, null, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.UnitID, "", new { @class = "text-danger" })
                    </div>
                        <div class="form-group">
                            <label class="control-label">Registration Number</label>

                            @Html.TextBoxFor(m => m.RegNumber, null, new { @class = "form-control" })
                            @Html.ValidationMessageFor(m => m.RegNumber, "", new { @class = "text-danger" })
                        </div>
                   
                      
                  
                      
                        <div class="form-group no-margin-bottom">
                            <label class="control-label">Skills</label>

                            @Html.TextBoxFor(m => m.Skills, null, new { @class = "form-control" })
                            @Html.ValidationMessageFor(m => m.Skills, "", new { @class = "text-danger" })
                        </div>

                  </div>
                    </div>


                    <div class="col-md-12">
                        <div class="white-box clearfix">
                               <div class="col-md-6"> 
                              <div class="form-group no-margin-bottom">
                        @if (Model.RolesList != null && Model.RolesList.Count > 0)
                        {

                            <div class="table-responsive">
                                <table id="employeeTable" class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Role Name</th>
                                            <th>
                                               <input type="checkbox" class="checkAll"/>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in Model.RolesList)
                                        {
                                            <tr id="@(item.RoleId)tr">
                                                <td>
                                                    
                                                        @item.RoleName
                                                  
                                                </td>
                                                <td>
                                                    <input type="checkbox" class="check" data-id="@(item.RoleId)" />
                                                   </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                    </div>

                           <button type="submit" class="btn btn-success" id="saveUser">Save</button>
                           <button type="reset" class="btn btn-white">Reset</button>
                        </div>
                          </div>
                    </div>
                   
                   
                        
                    
}

           
       
    </div>
</div>
<script>
    $(document).ready(function () {
        if(parseInt($('#ID').val())>0)
        {
            $('#UserName').attr('readonly','readonly');
        }

        $('.checkAll').change(function () {
            if ($(this).is(':checked')) {
                $('.check').prop('checked', true);
            }
            else 
                $('.check').prop('checked', false);
        });

        $('#saveUser').click(function () {
            var roles = [];
            $('.check:checked').each(function () {
                roles.push($(this).attr('data-id'));
            });

            $('#Roles').val(roles.join(','));
        });
        if($('#Roles').val().length>0)
        {
            var roles = $('#Roles').val().split(',');
            $(roles).each(function (i,item) {
                $('input[data-id=' + item + ']').prop('checked', true);
            });
        }
    });
</script>





